# GigMate Deployment Guide
## How to Deploy GigMate to Production

---

## Quick Start (5 Minutes)

### Option 1: Deploy to Vercel (Recommended)

1. **Create Vercel Account**
   ```bash
   # Visit vercel.com and sign up with GitHub
   ```

2. **Import Repository**
   - Click "Add New Project"
   - Import your GitHub repository
   - Vercel auto-detects Vite configuration

3. **Configure Environment Variables**
   ```
   VITE_SUPABASE_URL=your-supabase-url
   VITE_SUPABASE_ANON_KEY=your-supabase-anon-key
   VITE_STRIPE_PUBLISHABLE_KEY=your-stripe-key
   ```

4. **Deploy**
   - Click "Deploy"
   - Wait 2-3 minutes
   - Your site is live at `your-project.vercel.app`

5. **Add Custom Domain**
   - Go to Settings â†’ Domains
   - Add `gigmate.com`
   - Update DNS records (provided by Vercel)
   - SSL certificate auto-generated

### Option 2: Deploy to Netlify

1. **Create Netlify Account**
   ```bash
   # Visit netlify.com and sign up
   ```

2. **Import from Git**
   - Click "Add new site" â†’ "Import from Git"
   - Connect GitHub, select repository

3. **Build Settings**
   ```
   Build command: npm run build
   Publish directory: dist
   ```

4. **Environment Variables**
   - Go to Site Settings â†’ Environment Variables
   - Add VITE_SUPABASE_URL, VITE_SUPABASE_ANON_KEY, etc.

5. **Deploy**
   - Click "Deploy site"
   - Site live at `your-project.netlify.app`

---

## Detailed Setup

### Prerequisites

- âœ… GitHub account
- âœ… Supabase account (database already set up)
- âœ… Stripe account
- âœ… Domain name (optional, can use free subdomain)

### Step 1: Prepare Your Repository

1. **Create GitHub Repository**
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git remote add origin https://github.com/yourusername/gigmate.git
   git push -u origin main
   ```

2. **Verify Files**
   Ensure these files exist:
   - `package.json`
   - `vite.config.ts`
   - `index.html`
   - `.gitignore` (includes `.env`)

### Step 2: Set Up Supabase

Your database is already configured! You just need the connection details:

1. **Get Credentials**
   - Go to Supabase Dashboard
   - Project Settings â†’ API
   - Copy:
     - Project URL (`VITE_SUPABASE_URL`)
     - Anon/Public key (`VITE_SUPABASE_ANON_KEY`)

2. **Verify Database**
   - Go to Table Editor
   - Verify all tables exist (profiles, musicians, venues, etc.)
   - All migrations should be applied

### Step 3: Set Up Stripe

1. **Create Stripe Account**
   - Go to stripe.com
   - Sign up (free)

2. **Get API Keys**
   - Dashboard â†’ Developers â†’ API Keys
   - Copy Publishable Key for frontend
   - Copy Secret Key for backend (Edge Functions)

3. **Configure Webhooks**
   ```
   Endpoint URL: https://your-project.supabase.co/functions/v1/stripe-webhook
   Events to send:
   - payment_intent.succeeded
   - payment_intent.failed
   - checkout.session.completed
   - subscription.updated
   - subscription.deleted
   ```

4. **Get Webhook Secret**
   - After creating webhook, copy signing secret
   - Store as `STRIPE_WEBHOOK_SECRET`

### Step 4: Deploy to Vercel

1. **Install Vercel CLI (Optional)**
   ```bash
   npm install -g vercel
   vercel login
   vercel
   ```

2. **Configure Project**
   ```bash
   # Create vercel.json (already exists in project)
   {
     "buildCommand": "npm run build",
     "outputDirectory": "dist",
     "framework": "vite"
   }
   ```

3. **Add Environment Variables**
   - Vercel Dashboard â†’ Settings â†’ Environment Variables

   ```
   VITE_SUPABASE_URL=https://your-project.supabase.co
   VITE_SUPABASE_ANON_KEY=your-anon-key
   VITE_STRIPE_PUBLISHABLE_KEY=pk_live_...
   ```

4. **Deploy Edge Functions**
   Edge functions are deployed to Supabase, not Vercel:
   ```bash
   # Already deployed via migrations!
   # Functions available at:
   # https://your-project.supabase.co/functions/v1/stripe-checkout
   # https://your-project.supabase.co/functions/v1/stripe-webhook
   # https://your-project.supabase.co/functions/v1/send-email
   ```

5. **Set Production Environment**
   - Vercel Dashboard â†’ Settings â†’ Environment
   - Set variables for "Production"
   - Redeploy

### Step 5: Custom Domain

1. **Purchase Domain**
   - GoDaddy, Namecheap, Google Domains, etc.
   - Recommended: `gigmate.com`

2. **Add to Vercel**
   - Vercel Dashboard â†’ Domains
   - Add `gigmate.com` and `www.gigmate.com`

3. **Update DNS**
   ```
   A Record:
   @ â†’ 76.76.21.21

   CNAME Record:
   www â†’ cname.vercel-dns.com
   ```

4. **Wait for DNS Propagation**
   - 5 minutes to 48 hours
   - Check with `dig gigmate.com`

5. **SSL Certificate**
   - Auto-generated by Vercel
   - Force HTTPS in settings

---

## Environment Variables Reference

### Frontend (.env)

```bash
# Supabase
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# Stripe (Frontend)
VITE_STRIPE_PUBLISHABLE_KEY=pk_live_51...

# Optional: Analytics
VITE_GA_TRACKING_ID=G-XXXXXXXXXX
```

### Backend (Supabase Edge Functions)

These are automatically available in Edge Functions:
```bash
# Pre-configured by Supabase:
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=eyJhbG...
SUPABASE_SERVICE_ROLE_KEY=eyJhbG... (secret)

# You need to add:
STRIPE_SECRET_KEY=sk_live_51... (in Supabase Dashboard)
STRIPE_WEBHOOK_SECRET=whsec_... (in Supabase Dashboard)
```

To add Stripe keys to Supabase:
1. Supabase Dashboard â†’ Project Settings â†’ Edge Functions
2. Add secrets:
   ```bash
   STRIPE_SECRET_KEY=sk_live_...
   STRIPE_WEBHOOK_SECRET=whsec_...
   ```

---

## Post-Deployment Checklist

### Security

- [ ] All environment variables set correctly
- [ ] No `.env` file committed to Git
- [ ] Stripe webhook signature verification enabled
- [ ] RLS policies enabled on all tables
- [ ] API keys rotated from test to production
- [ ] HTTPS enforced (no HTTP access)
- [ ] CORS configured properly
- [ ] Rate limiting enabled

### Functionality

- [ ] User registration works
- [ ] Login/logout works
- [ ] Profile creation works
- [ ] Search works
- [ ] Messaging works
- [ ] Booking flow works end-to-end
- [ ] Stripe payments work (test card: 4242 4242 4242 4242)
- [ ] Email notifications send
- [ ] Social media connections work
- [ ] Images upload correctly

### Performance

- [ ] Page load times <2 seconds
- [ ] Images optimized (WebP format)
- [ ] Database queries indexed
- [ ] CDN configured for static assets
- [ ] Lighthouse score 90+ (mobile & desktop)

### Monitoring

- [ ] Error tracking (Sentry recommended)
- [ ] Analytics (Google Analytics, Plausible)
- [ ] Uptime monitoring (UptimeRobot, Pingdom)
- [ ] Performance monitoring (Vercel Analytics)
- [ ] Database monitoring (Supabase Dashboard)

---

## Scaling Considerations

### When to Scale

**At 1,000 users:**
- âœ… Current setup handles this easily
- No changes needed

**At 10,000 users:**
- Consider Vercel Pro ($20/mo) for better performance
- Enable Supabase connection pooler
- Add caching layer (Redis/Upstash)

**At 100,000 users:**
- Upgrade Supabase to Pro ($25/mo)
- Add CDN (Cloudflare, Fastly)
- Consider edge caching
- Database read replicas

**At 1,000,000 users:**
- Dedicated infrastructure
- Multiple database regions
- Load balancing
- Microservices architecture (maybe)

### Database Scaling

**Current Setup:**
- Supabase Free: 500MB database, 2GB bandwidth
- Good for: 10,000 users

**Growth Path:**
- Pro ($25/mo): 8GB database, 50GB bandwidth â†’ 100,000 users
- Team ($599/mo): 100GB database, 250GB bandwidth â†’ 1M users
- Enterprise: Custom pricing â†’ Unlimited

**Optimization Tips:**
- Indexes already created (done!)
- Connection pooling (enable in Supabase)
- Query optimization (use EXPLAIN ANALYZE)
- Archive old data (bookings >2 years)

---

## Continuous Deployment

### Automatic Deploys

Vercel automatically deploys on every push to `main`:

```bash
git add .
git commit -m "Add new feature"
git push origin main
# Vercel auto-deploys in 2-3 minutes
```

### Preview Deployments

Every pull request gets a preview URL:

```bash
git checkout -b feature/new-feature
git add .
git commit -m "New feature"
git push origin feature/new-feature
# Create PR on GitHub
# Vercel creates preview at: https://gigmate-abc123.vercel.app
```

### Rollback

If something breaks:

```bash
# Via Vercel Dashboard:
# Deployments â†’ Find last good deploy â†’ Promote to Production

# Via CLI:
vercel rollback
```

---

## Monitoring & Alerts

### Error Tracking (Sentry)

1. **Install Sentry**
   ```bash
   npm install @sentry/react @sentry/vite-plugin
   ```

2. **Configure**
   ```typescript
   // src/main.tsx
   import * as Sentry from "@sentry/react";

   Sentry.init({
     dsn: "https://...@sentry.io/...",
     environment: import.meta.env.MODE,
     tracesSampleRate: 1.0,
   });
   ```

3. **Test**
   ```typescript
   throw new Error("Test error");
   // Check Sentry dashboard for alert
   ```

### Uptime Monitoring (UptimeRobot)

1. Create account at uptimerobot.com
2. Add monitor:
   - URL: `https://gigmate.com`
   - Check interval: 5 minutes
3. Add alert contacts (email, SMS)

### Analytics (Plausible)

1. Create account at plausible.io
2. Add script to `index.html`:
   ```html
   <script defer data-domain="gigmate.com" src="https://plausible.io/js/script.js"></script>
   ```
3. View dashboard at plausible.io

---

## Troubleshooting

### "Site not loading"

**Check:**
1. DNS propagated? (`dig gigmate.com`)
2. Vercel deployment successful? (check dashboard)
3. Environment variables set? (Vercel settings)
4. Browser cache? (try incognito)

**Fix:**
```bash
# Redeploy
vercel --prod

# Check DNS
dig gigmate.com +short

# Clear Vercel cache
vercel --prod --force
```

### "Database connection failed"

**Check:**
1. Supabase URL correct?
2. Supabase key correct?
3. RLS policies allow access?
4. Table exists?

**Fix:**
```sql
-- Check RLS
SELECT tablename, policyname FROM pg_policies WHERE schemaname = 'public';

-- Disable RLS temporarily (testing only!)
ALTER TABLE profiles DISABLE ROW LEVEL SECURITY;
```

### "Stripe payments not working"

**Check:**
1. Live keys (not test keys)?
2. Webhook configured?
3. Webhook secret correct?
4. HTTPS enabled?

**Fix:**
```bash
# Test webhook
stripe listen --forward-to https://your-project.supabase.co/functions/v1/stripe-webhook

# Check Stripe logs
# Dashboard â†’ Developers â†’ Logs
```

### "Images not uploading"

**Check:**
1. Storage bucket created in Supabase?
2. RLS policies on storage?
3. File size limits?
4. CORS configured?

**Fix:**
```sql
-- Check storage policies
SELECT * FROM storage.objects WHERE bucket_id = 'avatars' LIMIT 1;

-- Create storage bucket if missing
INSERT INTO storage.buckets (id, name) VALUES ('avatars', 'avatars');
```

---

## Backup & Recovery

### Database Backups

**Automatic (Supabase):**
- Daily backups (last 7 days) on Pro plan
- Point-in-time recovery available

**Manual Backup:**
```bash
# Via Supabase Dashboard:
# Database â†’ Backups â†’ Backup Now

# Or via CLI:
pg_dump -h db.your-project.supabase.co -U postgres -d postgres > backup.sql
```

### Restore from Backup

```bash
# Via Supabase Dashboard:
# Database â†’ Backups â†’ Select backup â†’ Restore

# Or via CLI:
psql -h db.your-project.supabase.co -U postgres -d postgres < backup.sql
```

### Code Backups

Your code is on GitHub - always backed up!

```bash
# Clone fresh copy
git clone https://github.com/yourusername/gigmate.git

# Restore to specific commit
git checkout <commit-hash>
```

---

## Going Live Checklist

### Pre-Launch (1 Week Before)

- [ ] All features tested end-to-end
- [ ] Mobile responsive on all devices
- [ ] Stripe in live mode (not test mode)
- [ ] Custom domain configured
- [ ] SSL certificate valid
- [ ] Legal pages (Terms, Privacy) live
- [ ] Support email configured (support@gigmate.com)
- [ ] Beta testers given access
- [ ] Press kit prepared

### Launch Day

- [ ] Switch Stripe to live keys
- [ ] Switch Supabase to production database
- [ ] Enable monitoring (Sentry, UptimeRobot)
- [ ] Send launch email to beta testers
- [ ] Post on social media
- [ ] Submit to Product Hunt
- [ ] Monitor for errors (first 24 hours critical)

### Post-Launch (First Week)

- [ ] Fix any critical bugs immediately
- [ ] Monitor user feedback
- [ ] Check analytics daily
- [ ] Respond to support requests <24hrs
- [ ] Iterate based on feedback

---

## Support

### Documentation
- [Vercel Docs](https://vercel.com/docs)
- [Supabase Docs](https://supabase.com/docs)
- [Stripe Docs](https://stripe.com/docs)
- [Vite Docs](https://vitejs.dev/guide)

### Need Help?
- Email: dev@gigmate.com
- Discord: discord.gg/gigmate-dev
- GitHub Issues: github.com/gigmate/gigmate/issues

---

## Next Steps

1. **Deploy to Vercel** (follow Quick Start above)
2. **Test with real data** (create test bookings)
3. **Invite beta testers** (use Beta Tester Guide)
4. **Monitor performance** (set up Sentry, Analytics)
5. **Prepare for launch** (follow Going Live Checklist)

**Your platform is ready to scale! ðŸš€**

---

*Questions? Email: dev@gigmate.com*
